AIC(fit.psem2)
# add Growth~biomass back in
fit.psem3<-psem(
lme(Growth~bf +Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=k.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Att~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
fisherC(fit.psem3)
AIC(fit.psem3)
# remove att~bf
fit.psem4<-psem(
lme(Growth~bf +Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=k.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=k.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
fisherC(fit.psem4)
AIC(fit.psem4)
# remove att~prov
fit.psem5<-psem(
lme(Growth~bf +Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=k.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=k.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Prov%~~%Brood,
Food%~~%Biomass
)
fisherC(fit.psem5)
AIC(fit.psem5)
#remove Growth~att
fit.psem6<-psem(
lme(Growth~bf +Biomass+ Prov+Temp, random = ~1|Nest.ID, data=k.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=k.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
fisherC(fit.psem6)
AIC(fit.psem6)
summary(fit.psem) # model output
# add correlations
fit.psem1<-psem(
lme(Growth~Food+Biomass+ bf + Prov+Att +Temp, random = ~1|Nest.ID, data=k.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Att~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
summary(fit.psem1) # Food not sig with growth but is with temp
summary(fit.psem1.1) #
summary(fit.psem3) #
summary(fit.psem4a) #also checked but found no change when Growth%~~%Brood so left out
#drop growth~biomass
fit.psem4a<-psem(
lme(Growth~bf +Prov+Att +Temp, random = ~1|Nest.ID, data=k.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=k.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
summary(fit.psem4a) #also checked but found no change when Growth%~~%Brood so left out
# remove att~prov
fit.psem5<-psem(
lme(Growth~bf +Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=k.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=k.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Prov%~~%Brood,
Food%~~%Biomass
)
summary(fit.psem5) #  need to include att & prov
y
#remove Growth~att
fit.psem6<-psem(
lme(Growth~bf +Biomass+ Prov+Temp, random = ~1|Nest.ID, data=k.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=k.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=k.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
summary(fit.psem6) #
#### data with hem without growth####
hem.dat<-dat[,c(1:5,7:10)]
head(hem.dat)
hem.dat<-na.omit(hem.dat) # n = 179
#### models with hem use hem.dat 135 obs  #####
fit.hem.psem<-psem(
lme(Hem~bf +Food + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
summary(fit.hem.psem) # AIC 54.5, fit p = 0.79, 2 df #aic = 54.44, p = 0.80, df = 2
AIC(fit.hem.psem)
fisherC(fit.hem.psem)
# remove food
fit.hem.psem1<-psem(
lme(Hem~bf + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood
)
#use food instead of biomss
fisherC(fit.hem.psem1)
AIC(fit.hem.psem1)
fit.hem.psem1.1<-psem(
lme(Hem~bf + Food+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+bf, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood
)
summary(fit.hem.psem1.1) # aic 46.6 fit p = 0.73 df = 2
fisherC(fit.hem.psem1.1)
AIC(fit.hem.psem1.1)
# remove att~bf, temp~bf, prov~ bf
fit.hem.psem2<-psem(
lme(Hem~bf +Food + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
AIC(fit.hem.psem2)
fisherC(fit.hem.psem2)
#remove Att~Prov worse aic 62.68.  remove Hem~ Att & Temp
fit.hem.psem2.1<-psem(
lme(Hem~bf +Food + Biomass+ Prov, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
fisherC(fit.hem.psem2.1)
AIC(fit.hem.psem2.1)
# romove food
fit.hem.psem2.2<-psem(
lme(Hem~bf + Biomass+ Prov, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
fisherC(fit.hem.psem2.2)
AIC(fit.hem.psem2.2)
#### good but improved in 2.3.1####
fit.hem.psem2.3<-psem(
lme(Hem~ Biomass+ Prov, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
AIC(fit.hem.psem2.3)
fisherC(fit.hem.psem2.3)
# att Temp~~ATT
#### Best Hem so far####
fit.hem.psem2.3.1<-psem(
lme(Hem~ Biomass+ Prov, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass,
Temp%~~%Att
)
AIC(fit.hem.psem2.3.1)
fisherC(fit.hem.psem2.3.1)
# remove prov~food
fit.hem.psem2.4<-psem(
lme(Hem~ Biomass+ Prov, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Prov%~~%Brood,
Att%~~%Prov,
Food%~~%Biomass
)
fisherC(fit.hem.psem2.4)
AIC(fit.hem.psem2.4)
# add growth cor with hem (can't run hem and growth as Y)
fit.hem.psem.growth<-psem(
lme(Hem~bf +Food + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass,
Hem%~~%Growth
)
fisherC(fit.hem.psem.growth)
AIC(fit.hem.psem.growth)
fisherC(fit.hem.psem2.3.1)
AIC(fit.hem.psem2.3.1)
# load packages (install if you don't have them)
library(semPlot)
library(readr)
library(tidyr)
library(dplyr)
library(piecewiseSEM)
library(lme4)
library(nlme)
library(car)
full <- read_csv("data/full.csv")
levels(factor(full$Species.J))
full$Blowflies<-factor(full$Blowflies)
levels(factor(full$Blowflies)) # check levels and make consistent
levels(full$Blowflies)[levels(full$Blowflies)=="NO"]<-"No"
levels(full$Blowflies)[levels(full$Blowflies)=="YES"]<-"Yes"
levels(factor(full$Blowflies)) # check that now two levels No and Yes
#make bf a binary 0 1 for blowflies. 0 = No, 1 = yes
full$bf<-full$Blowflies
levels(full$bf)[levels(full$bf)=="No"] <- 0
levels(full$bf)[levels(full$bf)=="Yes"] <- 1
levels(factor(full$bf)) # check levels
full$Nestl.ID<-factor(full$Nestl.ID)
length(unique(full$Nestl.ID)) #348 nestlings
#### tidy data for use in analyses ####
#Because repeated measures of nestlings, need to get one row of data per nestling. Several steps
#First group data set by nestling ID.
by.nestling<-full%>%group_by(Nestl.ID) # multiple observations per nestling
# Next need one row of data per nestling for variables that will be used in analyses.
#First get mean values for the following variables
nestling<-by.nestling%>%
summarize_at(c("Vol.2","mass.A","Total.Trip.min", "T.perc","nestling.temp"), mean, na.rm=TRUE)
#Next use the following function to pull out 1 value per nestling for bf(blow fly presence absence),k (growth rate), hem (hematocrit)
nest.calc = function(nestl){
val<-by.nestling%>%filter(Nestl.ID == nestl)%>% # filter by nestling by.nestling data
select(Nestl.ID,bf,K,Hem,Nest.ID, Nestling.Max, Species.J, Vol.2)
bf.k.hem<-data.frame("Nestl.ID"=val[1,1], "bf"=val[1,2],"K"=val[1,3],"Hem"=val[1,4],"Nest.ID"=val[1,5], "Nestling.Max"=val[1,6], "Species.J"=val[1,7], "Vol.2"=val[1,8]) # only keep 1 value
}
list.bf.k.hem<-lapply(nestling$Nestl.ID, nest.calc) #apply function to get list of data frames
#The above will take a minute.
bf.k.hem<-bind_rows(list.bf.k.hem) # merge list of data frames --> n = 348
head(bf.k.hem)
nestling1<-cbind(nestling, bf.k.hem)
#### subset data to get only EABL ####
nestling1$Species<-factor(bf.k.hem$Species.J) # Species needs to be a factor to subset data
levels(factor(nestling1$Species)) #note TRES data are included
EABL<-subset(nestling1, Species=="EABL") #235 obs
str(EABL)
# if can work from modified data, delete data wrangling above
# not working though - get different values for psem. not sure why. delete this and start at next if can't get it.
EABL$Nest.ID<-factor(EABL$Nest.ID) # make nest ID a factor
#### name variables for path model ####
Food<-as.numeric(EABL$Vol.2) # Vol.2 is volume of arthropods 1-10mm
bf<-EABL$bf # will need to make numeric below
Temp<-as.numeric(EABL$nestling.temp)
Prov<-as.numeric(EABL$Total.Trip.min)
Att<-as.numeric(EABL$T.perc)
Growth<-as.numeric(EABL$K)
Nest.ID<-factor(EABL$Nest.ID)
Biomass<-EABL$mass.A  # biomass of arthropods
Brood<-EABL$Nestling.Max # maximum brood size recorded
Hem<-EABL$Hem
#create data frame with the following variables
dat<-data.frame(Food,Biomass, Temp, Prov, Att, Growth, Nest.ID,bf,Brood, Hem)
str(dat) # check
dat$Nestl.ID<-EABL$Nestl.ID #  add nestling ID to data frame
dat$bf<-as.numeric(EABL$bf) ##bf as numeric #problem in piecewiseSEM with bf as factor so made it numeric. Source for suggestion: jslefche.github.io/sem_book/categorical
#### data with hem without growth####
hem.dat<-dat[,c(1:5,7:10)]
head(hem.dat)
hem.dat<-na.omit(hem.dat) # n = 179
head(hem.dat)
View(hem.dat)
head(dat)
head(hem.dat)
#### models with hematocrit use hem.dat 135 obs (Aug 2021 n = 179) #####
fit.hem.psem<-psem(
lme(Hem~bf +Food + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
AIC(fit.hem.psem)
fisherC(fit.hem.psem)
# remove food
fit.hem.psem1<-psem(
lme(Hem~bf + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood
)
#use food instead of biomss
fisherC(fit.hem.psem1)
AIC(fit.hem.psem1)
fit.hem.psem1.1<-psem(
lme(Hem~bf + Food+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+bf, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood
)
fisherC(fit.hem.psem1.1)
AIC(fit.hem.psem1.1)
# remove att~bf, temp~bf, prov~ bf
fit.hem.psem2<-psem(
lme(Hem~bf +Food + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
summary(fit.hem.psem2) # aic 54.96 fit p = 0.54, 8df # Aic = 52.03, p = 0.85, df = 8
AIC(fit.hem.psem2)
fisherC(fit.hem.psem2)
#remove Att~Prov worse aic 62.68.  remove Hem~ Att & Temp
fit.hem.psem2.1<-psem(
lme(Hem~bf +Food + Biomass+ Prov, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
fisherC(fit.hem.psem2.1)
AIC(fit.hem.psem2.1)
# remove food
fit.hem.psem2.2<-psem(
lme(Hem~bf + Biomass+ Prov, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
fisherC(fit.hem.psem2.2)
AIC(fit.hem.psem2.2)
#### good but improved in 2.3.1####
fit.hem.psem2.3<-psem(
lme(Hem~ Biomass+ Prov, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
AIC(fit.hem.psem2.3)
fisherC()
fisherC(fit.hem.psem2.3)
# att Temp~~ATT
#### Best Hem so far####
fit.hem.psem2.3.1<-psem(
lme(Hem~ Biomass+ Prov, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass,
Temp%~~%Att
)
fisherC(fit.hem.psem2.3.1)
AIC(fit.hem.psem2.3.1)
summary(fit.hem.psem2.3.1) #aic 41.77, fit p = 0.94 df=6 Checked with hem~Temp - no effect and model a bit worse #Aic = 44.23, p = 0.65, df = 6
plot(fit.hem.psem2.3.1, node_attrs = list(shape="rectangle",color="black", show="std", x = 4), ns_dashed=TRUE, alpha=0.05) #
summary(fit.hem.psem2.3.1) #aic 41.77, fit p = 0.94 df=6 Checked with hem~Temp - no effect and model a bit worse #Aic = 44.23, p = 0.65, df = 6
fisherC(fit.hem.psem2.3.1)
AIC(fit.hem.psem2.3.1)
rsquared(fit.hem.psem2.3.1)
summary(fit.hem.psem2.3.1) #aic 41.77, fit p = 0.94 df=6 Checked with hem~Temp - no effect and model a bit worse #Aic = 44.23, p = 0.65, df = 6
fisherC(fit.hem.psem2.3.1)
AIC(fit.hem.psem2.3.1)
rsquared(fit.hem.psem2.3.1)
table(k.dat$Nest.ID) # check number of nestlings per nest. Need to use nest.ID as random variable! can't use Lavaan. need to use piecewiseSEM
#### K (growth) data with biomass####
k<-dat[,1:9] # exclude Hem Gives n = 235
k.dat<-na.omit(k) # n = 149
table(k.dat$Nest.ID) # check number of nestlings per nest. Need to use nest.ID as random variable! can't use Lavaan. need to use piecewiseSEM
length(k.dat$Nest.ID)
unique(k.dat$Nest.ID)
length(unique(k.dat$Nest.ID))
length(unique(hem.dat$Nest.ID))
#### models with hematocrit use hem.dat  (Aug 2021 n = 179; original was 135 obs) #####
fit.hem<-psem(
lme(Hem~bf +Food + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
)
#### models with hematocrit use hem.dat  (Aug 2021 n = 179; original was 135 obs) #####
fit.hem<-psem(
lme(Hem~bf +Food + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass+bf, random = ~1|Nest.ID, data=hem.dat))
summary(fit.hem) #
AIC(fit.hem)
fisherC(fit.hem)
# remove att~bf, temp~bf, prov~ bf
fit.hem.psem2<-psem(
lme(Hem~bf +Food + Biomass+ Prov+Att +Temp, random = ~1|Nest.ID, data=hem.dat),
lme(Prov~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Att~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
lme(Temp~Food+Biomass, random = ~1|Nest.ID, data=hem.dat),
Prov%~~%Temp,
Temp%~~%Brood,
Att%~~%Prov,
Prov%~~%Brood,
Food%~~%Biomass
)
summary(fit.hem.psem) #
summary(fit.hem.psem1) #
summary(fit.hem.psem) #
summary(fit.hem.psem1) #
summary(fit.hem.psem1.1) #
summary(fit.hem.psem2) # aic 54.96 fit p = 0.54, 8df # Aic = 52.03, p = 0.85, df = 8
f
summary(fit.hem.psem2) #
summary(fit.hem.psem2.1) #
summary(fit.hem.psem2.2) #
m
summary(fit.hem.psem2.3) #
summary(fit.hem.psem2.3.1) #aic 41.77, fit p = 0.94 df=6 Checked with hem~Temp - no effect and model a bit worse #Aic = 44.23, p = 0.65, df = 6
fisherC(fit.hem.psem2.3.1)
AIC(fit.hem.psem2.3.1)
summary(fit.hem.psem2.3.1) # Checked with hem~Temp - no effect and model a bit worse
